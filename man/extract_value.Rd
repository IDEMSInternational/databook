% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/epicsa_functions.R
\name{extract_value}
\alias{extract_value}
\title{Extract a numeric or text value from a calculation expression string}
\usage{
extract_value(string, value_expr, as_numeric = TRUE, after_asterisk = FALSE)
}
\arguments{
\item{string}{Character string containing the expression to parse.}

\item{value_expr}{Character string specifying the pattern that precedes the
value to extract (e.g., \code{"n="}, \code{"na.rm = "}, \code{"roll_sum_rain > "}).
This should include any literal characters appearing before the target value.}

\item{as_numeric}{Logical (default \code{TRUE}). If \code{TRUE}, extracts and converts
the value to numeric. If \code{FALSE}, extracts text until a whitespace or comma.#'}

\item{after_asterisk}{Logical. If \code{TRUE}, extract the numeric immediately after
a \code{"\*"}, e.g., in \code{"evap_var \* 0.5"} becomes \code{0.5}. This path always returns numeric.}
}
\value{
A numeric value if \code{as_numeric = TRUE}, otherwise a character value.
Returns \code{NA} if the value cannot be found.
}
\description{
Parses a string (typically a R-Instat calculation expression) and extracts
the value that appears after a specified pattern. Useful for pulling parameter
values (e.g., thresholds, window sizes, NA rules) from text-based calculation
expressions stored in metadata.
}
\details{
\itemize{
\item Numeric mode matches digits optionally followed by a decimal.
\item Text mode strips \verb{)} if present and stops at whitespace or comma.
\item Designed to work with strings produced by R-Instat calculation definitions.
}
}
\examples{
# Extract numeric window size
extract_value("roll_sum_rain(x, n=21)", "n=")
#> 21

# Extract threshold
extract_value("roll_sum_rain > 20", "roll_sum_rain > ")
#> 20

# Extract logical flag as text
extract_value("probs=yes", "probs=", as_numeric = FALSE)
#> "yes"

}
\seealso{
stringr::str_match
}
